<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Almet-Pulse | Correct Progress Flow</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --frost: rgba(255, 255, 255, 0.12);
            --frost-border: rgba(255, 255, 255, 0.2);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: #000;
            background-image: 
                radial-gradient(circle at 5% 5%, #1e3a8a 0%, transparent 40%),
                radial-gradient(circle at 95% 95%, #1e40af 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, #0a0f1d 0%, #000 100%);
            color: #fff;
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100vh;
            -webkit-tap-highlight-color: transparent;
        }

        .frost-panel {
            background: var(--frost);
            backdrop-filter: blur(40px) saturate(160%);
            -webkit-backdrop-filter: blur(40px) saturate(160%);
            border: 1px solid var(--frost-border);
        }

        /* Навигация без карты */
        .bottom-nav-wrapper {
            position: fixed;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
            width: 200px; /* Сузили панель */
        }

        .bottom-nav {
            height: 64px;
            background: rgba(255,255,255,0.08);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 32px;
            display: flex;
            justify-content: space-evenly;
            align-items: center;
        }

        .nav-icon {
            font-size: 18px;
            color: rgba(255,255,255,0.4);
            transition: all 0.3s ease;
            cursor: pointer;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .nav-icon.active {
            color: #fff;
            background: rgba(255,255,255,0.1);
        }

        .pay-trigger {
            width: 50px;
            height: 50px;
            background: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #000;
            box-shadow: 0 5px 15px rgba(255,255,255,0.2);
        }

        .screen {
            display: none;
            height: 100%;
            overflow-y: auto;
            padding: 50px 24px 130px;
            animation: fadeIn 0.3s ease;
        }

        .screen.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }

        /* Исправленный прогресс-бар: Справа Налево */
        .progress-container {
            width: 100%;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin-top: 12px;
            overflow: hidden;
            display: flex;
            justify-content: flex-start; /* Контент прижат к правому краю */
        }
        
        #progress-bar {
            height: 100%;
            background: linear-gradient(to left, #3b82f6, #60a5fa); /* Градиент тоже направлен влево */
            width: 100%;
            transition: width 1s linear;
            border-radius: 10px;
        }

        .map-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(30, 58, 138, 0.4));
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 28px;
            padding: 24px;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .map-card:active { transform: scale(0.97); }

        #qr {
            display: none; position: fixed; inset: 0; z-index: 200;
            background: rgba(0,0,0,0.9); backdrop-filter: blur(15px);
            flex-direction: column; align-items: center; justify-content: center;
        }

        .station-dot { position: absolute; width: 12px; height: 12px; background: #fff; border: 3px solid #1e3a8a; border-radius: 50%; transform: translate(-50%, -50%); }
    </style>
</head>
<body>

    <!-- HOME -->
    <div id="home" class="screen active">
        <header class="flex justify-between items-center mb-8">
            <h1 class="text-2xl font-extrabold tracking-tight">Almet-Pulse</h1>
        </header>

        <!-- Balance -->
        <div class="frost-panel p-6 rounded-[32px] mb-6 flex flex-col items-center">
            <span class="text-[10px] uppercase tracking-widest text-white/40 font-bold mb-1">Ваш кошелек</span>
            <div class="text-3xl font-black mb-4">580,00 ₽</div>
            <button class="bg-blue-600 px-6 py-2 rounded-full text-sm font-bold shadow-lg shadow-blue-900/40">Пополнить</button>
        </div>

        <!-- Progress (Right to Left) -->
        <div class="frost-panel p-5 rounded-[28px] mb-4">
            <div class="flex justify-between items-end mb-1">
                <div>
                    <p class="text-[10px] text-blue-400 font-black uppercase mb-1">Поезд через</p>
                    <p class="font-bold text-lg">Спортивная</p>
                </div>
                <div id="countdown" class="text-2xl font-black tracking-tighter">01:00</div>
            </div>
            <div class="progress-container">
                <div id="progress-bar"></div>
            </div>
        </div>

        <!-- Map Button In Main Menu -->
        <div onclick="show('map')" class="map-card mb-6">
            <div class="w-12 h-12 bg-blue-500 rounded-2xl flex items-center justify-center shadow-lg shadow-blue-500/30">
                <i class="fa-solid fa-map-marked-alt text-xl"></i>
            </div>
            <div>
                <p class="font-bold text-lg">Карта метро</p>
                <p class="text-xs text-white/50">Просмотр станций и веток</p>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="frost-panel p-5 rounded-[24px] flex flex-col gap-3">
                <i class="fa-solid fa-bolt text-yellow-400"></i>
                <span class="font-bold text-sm text-white/80">Самокаты</span>
            </div>
            <div class="frost-panel p-5 rounded-[24px] flex flex-col gap-3">
                <i class="fa-solid fa-clock-rotate-left text-purple-400"></i>
                <span class="font-bold text-sm text-white/80">История</span>
            </div>
        </div>
    </div>

    <!-- MAP SCREEN -->
    <div id="map" class="screen">
        <div class="flex items-center gap-4 mb-8">
            <button onclick="show('home')" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            <h2 class="text-xl font-bold">Схема метро</h2>
        </div>
        <div class="h-[400px] w-full rounded-[32px] bg-white/5 border border-white/10 relative overflow-hidden">
            <!-- Mock Line -->
            <div class="absolute w-[3px] h-full bg-blue-500 left-1/2 -translate-x-1/2 opacity-50"></div>
            <div class="station-dot top-1/4 left-1/2"></div>
            <div class="station-dot top-1/2 left-1/2"></div>
            <div class="station-dot top-3/4 left-1/2"></div>
        </div>
    </div>

    <!-- SETTINGS -->
    <div id="settings" class="screen">
        <div class="flex items-center gap-4 mb-8">
            <button onclick="show('home')" class="w-10 h-10 rounded-full bg-white/10 flex items-center justify-center">
                <i class="fa-solid fa-arrow-left"></i>
            </button>
            <h2 class="text-xl font-bold">Профиль</h2>
        </div>
        <div class="space-y-4">
            <div class="frost-panel p-5 rounded-3xl flex justify-between items-center">
                <span>Язык</span>
                <span class="text-white/40 text-sm font-bold">Русский</span>
            </div>
            <div class="frost-panel p-5 rounded-3xl flex justify-between items-center">
                <span>Версия</span>
                <span class="text-white/40 text-sm font-bold">1.5.0</span>
            </div>
        </div>
    </div>

    <!-- QR -->
    <div id="qr" onclick="this.style.display='none'">
        <div class="bg-white p-6 rounded-[40px] shadow-2xl mb-6">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=180x180&data=ALMET-PASS" class="w-40 h-40">
        </div>
        <div class="text-center">
            <p class="font-black text-2xl mb-1">Сканируйте</p>
            <p class="text-white/40 text-xs font-bold tracking-widest uppercase">Оплата проезда</p>
        </div>
    </div>

    <!-- NAV -->
    <div class="bottom-nav-wrapper">
        <nav class="bottom-nav">
            <div id="nav-home" onclick="show('home')" class="nav-icon active"><i class="fa-solid fa-house-chimney"></i></div>
            <div onclick="document.getElementById('qr').style.display='flex'" class="pay-trigger active:scale-90 transition-transform"><i class="fa-solid fa-qrcode text-lg"></i></div>
            <div id="nav-settings" onclick="show('settings')" class="nav-icon"><i class="fa-solid fa-circle-user"></i></div>
        </nav>
    </div>

    <script>
        let timeLeft = 60;
        const totalDuration = 60;

        function updateProgress() {
            const countdown = document.getElementById('countdown');
            const bar = document.getElementById('progress-bar');

            if (timeLeft <= 0) {
                timeLeft = totalDuration;
            } else {
                const s = timeLeft % 60;
                countdown.innerText = `00:${s.toString().padStart(2, '0')}`;
                
                // Чтобы бар шел справа налево:
                // Контейнер имеет flex-direction: row-reverse или justify-content: flex-end.
                // При 60 сек ширина 100%. При 0 сек ширина 0%.
                const percentage = (timeLeft / totalDuration) * 100;
                bar.style.width = percentage + '%';
                
                timeLeft--;
            }
        }

        function show(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            document.querySelectorAll('.nav-icon').forEach(n => n.classList.remove('active'));
            const n = document.getElementById('nav-' + id);
            if (n) n.classList.add('active');
        }

        setInterval(updateProgress, 1000);
        updateProgress();
    </script>
</body>
</html>